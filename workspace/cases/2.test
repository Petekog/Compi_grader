#use "semantic-analyser.ml";;
   
let input = Semantics.run_semantics  (Const
  (Sexpr
    (Pair
      (Pair (Symbol "lambda",
        Pair (Nil,
         Pair
          (Pair (Symbol "lambda",
            Pair (Pair (Symbol "x", Nil),
             Pair (Symbol "x",
              Pair
               (Pair (Symbol "lambda",
                 Pair (Nil,
                  Pair
                   (Pair (Symbol "set!",
                     Pair (Symbol "x", Pair (Number (Fraction (1, 1)), Nil))),
                   Nil))),
               Nil)))),
          Nil))),
      Nil))));;

let output = Const'
 (Sexpr
   (Pair
     (Pair (Symbol "lambda",
       Pair (Nil,
        Pair
         (Pair (Symbol "lambda",
           Pair (Pair (Symbol "x", Nil),
            Pair (Symbol "x",
             Pair
              (Pair (Symbol "lambda",
                Pair (Nil,
                 Pair
                  (Pair (Symbol "set!",
                    Pair (Symbol "x", Pair (Number (Fraction(1, 1)), Nil))),
                  Nil))),
              Nil)))),
         Nil))),
     Nil)));;                       
Printf.printf "%b" (List.for_all2 expr'_eq  [input] [output]);;

